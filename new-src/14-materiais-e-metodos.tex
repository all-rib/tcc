
Considerando os objetivos do projeto, definiu-se as seguintes etapas:

Busca de metodologias de sensoriamento de abelhas A. mellifera,
considerando-se os dispositivos mais comumente utilizados (sensor de
temperatura, umidade, pressão, microfone, e luminosidade). A busca
será feita através de ScienceDirect e Scholar Google. Esta etapa
nomea-se Busca.

Estudo da natureza de ambas as abelhas, levantando considerações sobre
suas semelhanças e diferenças que podem interferir nos métodos
conforme disposições dos próprios artigos. Essa etapa nomeia-se
Estudos.

Aplicação dos métodos de monitoramento, e extração dos dados, em
colméias de T. angustula, observando principalmente a necessidade de
adaptação dos métodos e suas diferenças, para registro. Essa etapa
nomeia-se Aplicação e registro.

Observação dos resultados obtidos e comparação dos métodos,
levantando suas diferenças, e dificuldades do processo. Essa etapa
nomeia-se Análise-comparativa.

\subsection{Busca}

 Foram buscado os termos colméia, monitoramento, abelha, modelo,
sensoriamento, precisão, apicultura, observando-se suas respectivas traduções para o inglês
(honeycomb, monitoring, bee;honeybee, model, sensoring, precision,
apiculture,). Adiante
listam-se as considerações mais importantes encontradas.

[4] faz uma pesquisa extensiva nos mesmos tópicos, provendo uma
revisão de literatura abrangente sobre o assunto. Suas pesquisas citam
a importância da umidade para a saúde geral, considerando regulação
térmica, prevenção da proliferação de fungos e bactérias, e
preservação das propriedades do mel para consumo das crias. Além
disso, a temperatura tem papel importante na regulação das atividades
realizadas pelos indivíduos, seja para produção direta de mel, ou
procriação e crescimento de novos indivíduos.

	Segundo a mesma autora, o som também possui uma enorme
importância, pois é um dos canais de comunicação de ações em
comportamento de enxame, tanto quanto num instante pontual e não periódico,
como para a transmissão de eventos (alertas sobre invasores, fontes de
alimento, intempéries climáticas), ou para comportamento sazonal (como
aumento de atividade de evaporação de umidade, ou enxameação). Outras
variáveis como peso e composição atmosférica também interferem.

Algumas metodologias de sensoriamento envolvem Machine Learning,
Análise de dados e visão computacional, 

	[trindade,2018] utiliza um sensor de temperatura e umidade, alem
de celulas para medir peso. Para transmissao dos dados, foi utilizado
um dispositivo Xbee, mas nao descreve detalhes sobre qualidade de
sinal, ou mesmo sobre o tipo de servidor utilizado, apontando apenas
que os dados foram processados utilizando-se microsoft excel.

	Estendendo a analise da obra de maneira hipotetica, pode se
estipular que parte da decisao de utilizar um dispositivo Xbee foi
devido a sua facilidade de conexao com a rede, por ser facilmente
interfaceavel com outros sistemas operacionais. Torna-se entao
evidente a necessidade de um sinal de telefonia movel, ou sinal de
internet para a transmissao dos dados para nuvem.

	Alem disso, trabalhos como [ferrari,2008, entre outros] possuem
uma taxa de captura muito maior de dados, estendendo não apenas
variáveis como temperatura e umidade, mas também microfone, e imagem,
o que cria um enorme fluxo de dados para serem processados,
inviabilizando o processamento local.

Análise de temperatura

	Trabalhos 





	Os sistemas idealmente precisam sensoriar ao menos um ponto
dentro, e um ponto fora da colmeia, permitindo assim observar a
diferen;a de temperatura. Isso se deve ao fato de que a variação de
temperatura do ambiente como um todo provoca alterações de
comportamento. Para manutenção da colméia, as abelhas fazem movimentos
para controle de umidade e temperatura, reduzindo assim efeitos desses
agentes sobre o ecossistema. Alterações no comportamento podem ser
observadas através da observação destes fenômenos, além de permitir a
identificação de fenômenos que provoquem estes comportamentos.

	Os sensores utilizados foram os sht30 para os ambientes externos.

O SHT30, desenvolvido pela Sensirion, é um sensor digital de
temperatura e umidade relativa altamente integrado, ideal para
aplicações em sistemas embarcados. Ele utiliza comunicação via I²C com
suporte a verificação de integridade CRC, o que o torna confiável
mesmo em ambientes com interferência elétrica. Possui calibração de
fábrica, o que elimina a necessidade de ajustes manuais, e oferece
alta precisão, com erro típico de ±2\% para umidade relativa e ±0,3 °C
para temperatura. Com baixo consumo de energia e encapsulamento
compacto (DFN-6), o SHT30 é amplamente utilizado em aplicações
industriais, automação residencial, dispositivos IoT e monitoramento
ambiental. Sua combinação de precisão, estabilidade e facilidade de
integração o torna uma escolha robusta e eficiente para projetos que
exigem sensoriamento ambiental confiável.

	Escolhidos pela disponibilidade e precisao, alem de possuírem um
sensor de umidade embarcado. seu tambanho também facilita o
posicitionamento em qualquer local da colmeia. O sensor possui
interface I2C, com velocidades de ate 1MHz, com acuracia de 1.5\% de
umidade relativa, e 0.1oc. Seu baixo consumo (1.5mA durante medicao, e
0.5uA em idle-mode) tambem e um fator
importante para a aplicacao, considerando que o dispositivo deve rodar
sem supervisao durante um grande periodo, utilizando baterias. Por
fim, o dispositivo nao necessita de calibracao.

No entanto, sua breakout board possui um circuito pequeno que pode
atrabalhar a insercao direta do sensor dentro da colmeia. Em
decorrencia de eventuais falhas, um foi posto do lado de fora, outro
do lado de dentro.

%TODO: revisar isso segundo datasheet()

	Para comparacao. e possibilidade de contato direto com o mel,
escolheu-se o DS18b20 por sua versatilivdade de encapsulamentos.

O DS18B20 é um sensor digital de temperatura fabricado pela Maxim
Integrated (atualmente parte da Texas Instruments), amplamente
utilizado em sistemas embarcados e aplicações industriais. Seu
destaque está na comunicação via 1-Wire, que permite a transmissão de
dados e alimentação por um único fio, simplificando o cabeamento em
sistemas distribuídos. O sensor oferece uma faixa de medição de -55 °C
a +125 °C, com precisão típica de ±0,5 °C na faixa entre -10 °C e
+85 °C, e resolução configurável de 9 a 12 bits. Além disso, cada
unidade possui um código único de 64 bits gravado de fábrica,
permitindo a identificação individual de múltiplos sensores conectados
em paralelo no mesmo barramento. Seu encapsulamento compacto (TO-92 ou
versões estanques em aço inox) e sua robustez tornam o DS18B20 ideal
para uso em ambientes externos, automação residencial, agricultura de
precisão e sistemas de monitoramento térmico distribuído.

	Para microfone, foi usado o INMP441, devido a disponibilidade,
familiaridade, e aplicacoes ja implementadas com esse mesmo
dispositivo. 

O INMP441 é um microfone digital do tipo MEMS
(Micro-Electro-Mechanical Systems), projetado para capturar sinais
acústicos com alta fidelidade e baixo ruído. Ele integra internamente
um conversor ADC de 24 bits e se comunica por meio da interface
digital I²S, permitindo a transmissão direta de áudio para
microcontroladores ou processadores de sinal sem a necessidade de
circuitos analógicos externos. O INMP441 apresenta uma faixa dinâmica
ampla e resposta em frequência plana, sendo capaz de captar sons entre
60 Hz e 15 kHz com boa sensibilidade. Sua arquitetura digital elimina
interferências comuns a microfones analógicos, tornando-o ideal para
aplicações como reconhecimento de voz, gravação de áudio embarcada,
sistemas de monitoramento acústico e dispositivos IoT com entrada
sonora. Com encapsulamento compacto e fácil integração em placas de
circuito impresso, o INMP441 oferece uma solução prática e robusta
para projetos embarcados que exigem captura de áudio de forma precisa
e eficiente.

	Para processamento e armazenamento das informacoes, foi utilizado
uma placa LORA32 da LILYGO, devida ao seu hardware integrado para uso
de cartoes SD. Isso permite a gravacao dos dados durante um grande
periodo, se considerar a disponibilidade de armazenamento no que tange
cartoes de memoria do tipo microSD.

	O dispositivo possui recomendações de alimentação de 5V pela porta
USB [17], mas durante erros de conexão, o controlador foi alimentado
com 8.1 volts em sua porta USB, continuando a operar sem problemas
aparentes.

[imagem lilygo]

Para integração dos sensores, cabeamento de rede do tipo cat6 foi
utilizado afim de reduzir possiveis efeitos de interferencia externa.
Esse cabo foi escolhido pela especificidade de nao interferencia de
crosstalk, um problema comum na utilizacao de conectores[15].

	Para adaptação dos cabos CAT6, foi necessario uma pequena topologia
para interligar os sensores à placa. A exposição às intempéries me
impede de utilizar um conector que unificasse todos os sensores (como
o RJ45), obrigando a utilizar uma conexão dedicada à cada um dos
sinais: VCC, GND, SDA e SCL.

[imagem topologia]

[imagem conectores]

	Um total de 4 sensores foram conectados, dois do tipo SHT30, e
dois BME280. Os sensores, quando utilizados em par, permitem obter
dados de desvios entre os sensores sensores.

	Os sensores foram conectados em paralelo, permitindo que
sejam consultados sob demanda. Graças à arquitetura i2c, mais de um sensor do mesmo
tipo pode ser utilizado na mesma linha: Os dispositivos são
endereçados de fábrica, e um ou mais bits podem ser alterados
manualmente. O endereçamento é determinado por 7 bits (0b111011x),
sendo os 6 MSB (most-significant-bits) constantes, e o menos
significativo controlado pelo nivel lógico da porta SDO. A conexão
entre SDO e GND força o endereço 0b1110110 (0x76), e a conexão com
VDDIO resulta em 0b1110111 (0x77). O pino não pode flutuar.

	Se necessário, em um trabalho futuro, mais de dois dispositivos do
mesmo tipo poderão ser conectados, aproveitando um detalhe da
arquitetura SPI, que utiliza um terceiro sinal (denominado CS, ou
chip-select) para controlar a seleção de um dispositivo. Neste caso, o
sinal SDO tem a mesma função do CS, mantendo todos os dispositivos com
o mesmo endereço (0x76). Quando for necessário consulta, a linha SDO
deve sofrer pull-up, alterando o endereço para 0x77, destacando-o como
tendo um endereço exclusivo, e portanto responderá individualmente. Ao
final da operação, a linha deve novamente sofrer pull-down, liberando
o canal.

	Os sensores, interligados entre si, em um primeiro teste foram
posicionados fora do mel, no sobreninho mais superior, o mais distante
do contato com os favos, prevendo possiveis problemas de funcionamento
dos sensores devido exposição ao mel e a cera.

%% Falar sobre o teste de mergulhar o sensor no mel.

	O canal para transposição dos fios foi selado utilizando-se uma
mistura de cera de abelha derretida com própolis, extraído a partir de
outras colméias da mesma espécie. A selagem é necessária devido ao
ataque de outros insetos, em especial formigas e fungos, que se
aproveitam do ponto de abertura que os cabos provocam. A cera, quando
semi-derretida e maleável é capaz de selar a entrada dos fios, por se
moldar naturalmente à passagem de cabos, criando um canal justo, e
facilmente renovável, além de ser familiar para os indivíduos da
colônia. O própolis, por sua vez, é um poderoso antiséptico natual, o
que evita a proliferação de fungos e bactérias na região. O selamento
da entrada também pode ser feita com fita, mas esta se degrada com a
chuva e umidade, e as abelhas ainda terão o trabalho de selar a caixa
internamente com cera e própolis.

	Finalmente, o microcontrolador, bem como uma bateria de
alimentação, foram isolados entre sí, e inseridos em frascos de
conserva. Isso foi necessário devido exposição à umidade. Os buracos
na tampa foram selados com cola-quente, e os frascos dispostos de
ponta cabeça, de forma que a tampa ficasse embaixo, evitando que água
acumulasse proximos aos conectores.

	Um conector foi deixado do lado de fora, para facilitar a troca de
bateria, caso necessário. Eventualmente, problemas na rotina do
microcontrolador drenaram a bateria completamente. Isso deu origem à
necessidade de criar um sistema robusto de detecção de erros, uma vez
que erros do tipo hard-fault, por padrão, resultam num loop infinito
em determinado ponto do programa. A ideia original, é que o usuário
seja capaz de debuggar e verificar o sistema neste ponto, seja rodando
o programa de trás pra frente, inspecionando a memória, stack, entre
outros recursos.

	Uma solução é o registro de alguns pontos para futura
correção: conjunto subsequente de chamadas que levou à execução até a
instrução fatal (stack), um snapshot de pontos importantes da memória,
memory-dump, eventos ocorridos, que possam ter provocado o erro,
event-log, e por fim, características físicas do dispositivo, como
temperatura, níveis de tensão e corrente, quando possível. Mas além de
tudo isso, a função original de hard-fault precisa ser reescrita, de
preferência a resetar o dispositivo.

	A captura e gravação dos dados foram feitas através de consulta, e em
seguida armazenadas através de uma função atômica de escrita, em um
arquivo de texto, seguindo um padrão de time-stamp:

[#n][Nome]([medida][unidade])\\+

Esse padrão, posteriormente implementado atraves da biblioteca hermes [16], foi
utilizado por fornecer contexto de origem, instante e leitura de um
sensor, consideradas suficientes para a naturza desta aplicação.

	No decorrer do trabalho, problemas de debug in-loco firmaram a
necessidade de reformular o processo, como será explicado mais
adiante.

	Além disso, a biblioteca foi implementada com uma análise de
requisitos, a saber

'''
* - Only it can write. Other actors must rely on this to write.
* 
* - Must write, no matter what happens (i.e. write must always
* succeed);
* 
* This means that if for any reason, the media fails to be written to,
* the actor must be able to hold-on information for long enough, or
* provide necessary means to easy the load of current write, until the
* write media goes back to normal;
* 
* This is intended, of course, to guarantee every information will be
* kept.
* 
* - Must, while writing, lock any actor from reading it;
* 
* This is to prevent incomplete/inaccurate info retrieval (i.e. atomic
* write/read operations)
* 
* - Must, while reading, lock any actor from writing it;
* 
* - Must handle parallel writes/reads;
* 
* - Must generate its own events (be able to log itself in event-driven
* manner);
'''

	Dentre os requisitos, destacam se dois importantes: "Must write,
no matter what happens", essencial para a garantia de telemetria dos
sensores, e "must handle parallel writes/reads", conveniente à
implementação de diversos sensores para escrita e leitura simultânea.

	Para tratar do primeiro requisito, foi desenvolvida uma nova
biblioteca, afim de lidar com o problema de pouca memória presente no
micro, prevendo a possivel falha de todos os canais de comunicacoes do
sistema, por diversas razões.

	Para métodos de lidar com dados seriais, pode-se citar fila como
sendo a mais comum. A fila possui um modelo first-in, first out (FIFO)
de consulta, permitindo que n séries s de dados sejam capturados, e para
amostragem ser uniforme, os dados são amostrados numa frequencia f.

	No entanto, a lotação da memória por outros processos pode fazer
com que dados sejam perdidos, de forma que alguma série pode não ser
subsequente à outra. Para corrigir isso, uma opção é reduzir a
frequência de captura, por consequência diminuindo sua resolução, em
detrimento da garantia de captura de pelo menos um dado durante o
período em que a memória ficou lotada.

	Além disso, também é possivel o agrupamento dos dados em séries,
dado que os dados tem um intervalo bem definido de possilibdades,
bastando apenas guardar os instantes de tempo no qual o mesmo ocorre.

	Outro auxílio é possivel através do uso de média movel, para
garantia que os dados, ainda que esparços, sejam capazes de
representar a média de valores de um intervalo.

	Por fim, pode-se ainda compactar os valores, procedendo para
escrita numa mídia de armazenamento em massa, ou transmissão para
posterior consulta.

	A biblioteca, nomeada de Sparse-Buffer, possui todas as
funcionalidades citadas a cima, utilizada
	



A bateria acabar

Algum cabo falhar

Algum sensor falhar

	- como descobrir a diferença de falha do sensor, ou falha do cabo?
talvez testar um curto local

a rede falhar

 - como unificar os canais de rede em uma biblioteca só?

o armazenamento falhar











	Outro aspecto importante de pensar foi a forma de posicionar os
sensores.






Lembrar de falar que nao possuir osciloscopio disponivel em campo
dificultou muita coisa

Possivel efeito capacitivo do contato de circuito i2c com umidade

falar sobre hard-fault que engole energia no esp

falar sobre a necessidade de um debug remoto






% Achar um argumento melhor pra essa porra.


	Alem disso, a exposicao de eletronicos no mel é um assunto sem
publicações. No entanto, estende-se parte das implicações da presença
de umidade nessas aplicações.

	Um problema comum em I2C é sua sensibilidade a efeitos capacitivos
na linha

% https://www.eevblog.com/forum/projects/i2c-pcb-design-trace-length-and-interference/
%
% descobrir como a resistencia afeta o efeito de bordas na i2c

%Lembrar de falar que nao possuir osciloscopio disponivel em campo
%dificultou muita coisa

% Possivel efeito capacitivo do contato de circuito i2c com umidade

% falar sobre hard-fault que engole energia no esp

% falar sobre a necessidade de um debug remoto





[fotografia cabo de rede]

	

	A comunicação funciona no modelo mestre-escravo, destacando o
controlador no papel de mestre, responsável por fornecer o clock (SCL)
principal, bem como transmitir a requisiçaõ de um dispositivo por seu
respectivo endereço, e receber a sequencia de respostas.

[Imagem de topologia de rede]

	Para consulta dos sensores, 

I2C



\subsection{Estudos}

\subsubsection{Temperatura}



\subsection{Aplicação e registro}
\subsection{Análise Comparativa}
















